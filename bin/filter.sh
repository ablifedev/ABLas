more novel_as_SE_uniq_sj | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{@dd=split(/,/,$line[5]);$num=$#dd+1;$avg=sum(@dd)/$num;$ratio=$line[7]/($avg+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_SE_uniq_sj_filter
more novel_as_CE_uniq | perl -ne 'use List::Util qw(sum min);chomp;@line=split(/\t/);@dd=split(/,/,$line[5]);next if min(@dd)<2;$num=$#dd+1;$avg=sum(@dd)/$num;if($avg>=5){print $_,"\n";}else{$ratio=$avg/($avg+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_CE_uniq_sj_filter
more novel_as_MXE_uniq_sj | perl -ne 'use List::Util qw(sum min);chomp;@line=split(/\t/);@dd=split(/,/,$line[5]);@tt=split(/,/,$line[7]);$avg=sum(@dd)/2;$avg2=sum(@tt)/2;if($line[-1]=~/structure\s\"3/){next if min(@tt)<2;if($avg2>=5){print $_,"\n";}else{$ratio=$avg2/($avg+$avg2);if($ratio>=0.15){print $_,"\n";}}}else{next if min(@dd)<2;if($avg>=5){print $_,"\n";}else{$ratio=$avg/($avg+$avg2);if($ratio>=0.15){print $_,"\n";}}}' > novel_as_MXE_uniq_sj_filter
more novel_as_A3SS_uniq_sj | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_A3SS_uniq_sj_filter
more novel_as_EE_uniq_sj | perl -ne 'use List::Util qw(sum min);chomp;@line=split(/\t/);@dd=split(/,/,$line[5]);@tt=split(/,/,$line[7]);$avg=sum(@dd)/2;$avg2=sum(@tt)/2;if($line[-1]=~/structure\s\"2/){next if min(@tt)<2;if($avg2>=5){print $_,"\n";}else{$ratio=$avg2/($avg+$avg2);if($ratio>=0.15){print $_,"\n";}}}else{next if min(@dd)<2;if($avg>=5){print $_,"\n";}else{$ratio=$avg/($avg+$avg2);if($ratio>=0.15){print $_,"\n";}}}' > novel_as_EE_uniq_sj_filter
more novel_as_ALE_uniq_sj | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_ALE_uniq_sj_filter
more novel_as_AFE_uniq_sj | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_AFE_uniq_sj_filter
more novel_as_A5SS_uniq_sj | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_A5SS_uniq_sj_filter
more novel_as_II_uniq_sj | perl -ne 'use List::Util qw(sum min);chomp;@line=split(/\t/);if($line[-1]=~/structure\s\"2/){next if $line[7]<2;if($line[7]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[7]+$line[5]);if($ratio>=0.15){print $_,"\n";}}}else{next if $line[5]<2;if($line[5]>=5){print $_,"\n";}else{$ratio=$line[5]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}}' > novel_as_II_uniq_sj_filter
more novel_as_IR_uniq_sj2 | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[-1]<2;if($line[-1]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > novel_as_IR_uniq_sj2_filter
more raw_introR_events_uniq_sj2 | perl -ne 'use List::Util qw(sum);chomp;@line=split(/\t/);next if $line[-1]<2;if($line[-1]>=5){print $_,"\n";}else{$ratio=$line[7]/($line[5]+$line[7]);if($ratio>=0.15){print $_,"\n";}}' > raw_introR_events_uniq_sj2_filter
